<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SNS ì¶œê°• í›„ê¸° ë§ˆìŠ¤í„° ìƒì„±ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700&display=swap');
        body { font-family: 'Pretendard', sans-serif; }
        .insta-gradient { background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%); }
        .blog-gradient { background: #2db400; }
        .loading-spinner { animation: spin 1s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 antialiased">

    <div class="max-w-6xl mx-auto px-4 py-8">
        <!-- Header -->
        <header class="mb-8 text-center bg-white p-6 rounded-2xl shadow-sm border border-blue-100">
            <h1 class="text-3xl font-extrabold text-blue-600 mb-2">ğŸš€ SNS ì¶œê°• í›„ê¸° ë§ˆìŠ¤í„° ìƒì„±ê¸°</h1>
            <p class="text-slate-500 font-semibold">
                ê°œë°œì: <span class="text-blue-700">ê°€ì¹˜ìˆëŠ”ë¯¸ë˜êµìœ¡ì—°êµ¬ì†Œ ëŒ€í‘œ ê¹€ë³‘ì°¬</span>
            </p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            
            <!-- Left Column: Settings & Input -->
            <div class="lg:col-span-4 space-y-6">
                
                <!-- API Key Section -->
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
                    <label class="flex items-center gap-2 text-sm font-bold text-slate-700 mb-2">
                        <i class="fas fa-key text-blue-500"></i>
                        Gemini API Key
                    </label>
                    <input 
                        type="password" 
                        id="apiKey" 
                        placeholder="API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”" 
                        class="w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none transition-all"
                    >
                </div>

                <!-- Lecture Info Form -->
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 space-y-4">
                    <h3 class="font-bold text-lg text-slate-800 flex items-center gap-2 mb-2">
                        <i class="fas fa-circle-plus text-blue-500"></i>
                        ê°•ì˜ ì •ë³´ ì…ë ¥
                    </h3>

                    <div class="space-y-4">
                        <div>
                            <label class="text-xs font-semibold text-slate-500 uppercase tracking-wider block mb-1">ì¶œê°• ë‚ ì§œ</label>
                            <input type="date" id="lectureDate" class="w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none">
                        </div>

                        <div>
                            <label class="text-xs font-semibold text-slate-500 uppercase tracking-wider block mb-1">ì¶œê°• ì§€ì—­ ë° ê¸°ê´€</label>
                            <div class="grid grid-cols-2 gap-2">
                                <input type="text" id="region" placeholder="ì§€ì—­(ì˜ˆ: ì„œìš¸)" class="px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none">
                                <input type="text" id="location" placeholder="ê¸°ê´€/í•™êµëª…" class="px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none">
                            </div>
                        </div>

                        <div>
                            <label class="text-xs font-semibold text-slate-500 uppercase tracking-wider block mb-1">ê°•ì˜ ëŒ€ìƒ</label>
                            <input type="text" id="target" placeholder="ì˜ˆ: ê³ ë“±í•™ìƒ, êµì‚¬, ê¸°ì—… ì„ì›" class="w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none">
                        </div>

                        <div>
                            <label class="text-xs font-semibold text-slate-500 uppercase tracking-wider block mb-1">ê°•ì˜ ì£¼ì œ</label>
                            <input type="text" id="subject" placeholder="ê°•ì˜ ì œëª© ë˜ëŠ” í•µì‹¬ ì£¼ì œ" class="w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none">
                        </div>

                        <div>
                            <label class="text-xs font-semibold text-slate-500 uppercase tracking-wider block mb-1">íŠ¹ì´ì‚¬í•­ (ê°•ì¡° í¬ì¸íŠ¸)</label>
                            <textarea id="notes" placeholder="í˜„ì¥ ë°˜ì‘, í™œìš©í•œ ì—ë“€í…Œí¬ ë„êµ¬, ê°ë™ì ì¸ ìˆœê°„ ë“±" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none min-h-[120px]"></textarea>
                        </div>
                    </div>

                    <button 
                        onclick="generateAllPosts()" 
                        id="generateBtn"
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl transition-all shadow-lg shadow-blue-200 flex items-center justify-center gap-2"
                    >
                        <i class="fas fa-paper-plane" id="btnIcon"></i>
                        <span id="btnText">ì „ì²´ í¬ìŠ¤íŒ… ìƒì„±í•˜ê¸°</span>
                    </button>
                </div>
            </div>

            <!-- Right Column: Results -->
            <div class="lg:col-span-8 space-y-6">
                
                <!-- Instagram Card -->
                <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="insta-gradient p-4 flex justify-between items-center text-white font-bold">
                        <span class="flex items-center gap-2"><i class="fab fa-instagram text-xl"></i> ì¸ìŠ¤íƒ€ê·¸ë¨ìš© í¬ìŠ¤íŒ…</span>
                        <div class="flex gap-2">
                            <button onclick="generateSinglePost('instagram')" class="p-1.5 hover:bg-white/20 rounded-lg transition-colors" title="ë‹¤ì‹œ ìƒì„±">
                                <i class="fas fa-rotate" id="refresh-instagram"></i>
                            </button>
                            <button onclick="copyContent('instaResult', 'instaBtnText')" class="flex items-center gap-1 px-3 py-1 bg-white text-pink-600 text-sm rounded-lg hover:bg-slate-50 transition-colors">
                                <i class="fas fa-copy"></i> <span id="instaBtnText">ë³µì‚¬í•˜ê¸°</span>
                            </button>
                        </div>
                    </div>
                    <div class="p-6">
                        <div id="instaResult" class="whitespace-pre-wrap text-slate-700 leading-relaxed text-sm md:text-base bg-slate-50 p-4 rounded-xl border border-slate-100 min-h-[150px]">ì •ë³´ë¥¼ ì…ë ¥í•˜ê³  ìƒì„± ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</div>
                    </div>
                </div>

                <!-- Blog Card -->
                <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="blog-gradient p-4 flex justify-between items-center text-white font-bold">
                        <span class="flex items-center gap-2"><i class="fas fa-blog text-xl"></i> ë„¤ì´ë²„ ë¸”ë¡œê·¸ìš© í¬ìŠ¤íŒ…</span>
                        <div class="flex gap-2">
                            <button onclick="generateSinglePost('blog')" class="p-1.5 hover:bg-white/20 rounded-lg transition-colors" title="ë‹¤ì‹œ ìƒì„±">
                                <i class="fas fa-rotate" id="refresh-blog"></i>
                            </button>
                            <button onclick="copyContent('blogResult', 'blogBtnText')" class="flex items-center gap-1 px-3 py-1 bg-white text-emerald-600 text-sm rounded-lg hover:bg-slate-50 transition-colors">
                                <i class="fas fa-copy"></i> <span id="blogBtnText">ë³µì‚¬í•˜ê¸°</span>
                            </button>
                        </div>
                    </div>
                    <div class="p-6">
                        <div id="blogResult" class="whitespace-pre-wrap text-slate-700 leading-relaxed text-sm md:text-base bg-slate-50 p-4 rounded-xl border border-slate-100 min-h-[200px]">ë¸”ë¡œê·¸ëŠ” SEOì— ìµœì í™”ëœ ì •ë³´ì„± ê¸€ë¡œ ìƒì„±ë©ë‹ˆë‹¤.</div>
                    </div>
                </div>

                <!-- Advice -->
                <div class="bg-blue-50 p-4 rounded-xl border border-blue-100 flex gap-3 text-blue-800 text-sm">
                    <i class="fas fa-lightbulb text-xl mt-0.5"></i>
                    <div>
                        <p class="font-bold mb-1">ì„±ê³µì ì¸ í¬ìŠ¤íŒ… íŒ</p>
                        <p>ìƒì„±ëœ í…ìŠ¤íŠ¸ë¥¼ ë³µì‚¬í•œ í›„, ë„¤ì´ë²„ ë¸”ë¡œê·¸ ì—ë””í„°ì—ì„œ ì¤‘ê°„ì¤‘ê°„ ê´€ë ¨ ì‚¬ì§„ë§Œ ì¶”ê°€í•´ ì£¼ì‹œë©´ ì™„ë²½í•œ í›„ê¸°ê°€ ì™„ì„±ë©ë‹ˆë‹¤!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Set Default Date to Today
        document.getElementById('lectureDate').value = new Date().toISOString().split('T')[0];

        async function fetchAI(prompt) {
            const apiKey = document.getElementById('apiKey').value;
            if (!apiKey) {
                alert('API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return null;
            }

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const systemPrompt = `ë‹¹ì‹ ì€ 'ê°€ì¹˜ìˆëŠ” ë¯¸ë˜êµìœ¡ì—°êµ¬ì†Œ' ëŒ€í‘œ ê¹€ë³‘ì°¬ ë‹˜ì˜ í¼ìŠ¤ë„ ë¸Œëœë”©ì„ ë•ëŠ” ì „ë¬¸ ì†Œì…œ ë¯¸ë””ì–´ ë§ˆì¼€í„°ì…ë‹ˆë‹¤. ê¹€ë³‘ì°¬ ë‹˜ì€ ë¯¸ìˆ êµì‚¬ ì¶œì‹ ì´ì ê³ ë“±í•™êµ ë¯¸ìˆ  ê°•ì‚¬, ì—ë“€í…Œí¬/ìƒì„±í˜• AI/ë¦¬ë”ì‹­ ì „ë¬¸ ê°•ì‚¬ì…ë‹ˆë‹¤. í…ìŠ¤íŠ¸ ìƒì„± ì‹œ ë§ˆí¬ë‹¤ìš´ ê¸°í˜¸(###, **, __ ë“±)ë¥¼ ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ë§ê³ , í‰ë¬¸(Plain Text)ìœ¼ë¡œë§Œ ì‘ì„±í•˜ì„¸ìš”.`;

            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] }
            };

            let delay = 1000;
            for (let i = 0; i < 5; i++) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    if (!response.ok) throw new Error('API Fail');
                    const data = await response.json();
                    return data.candidates?.[0]?.content?.parts?.[0]?.text;
                } catch (error) {
                    if (i === 4) throw error;
                    await new Promise(r => setTimeout(r, delay));
                    delay *= 2;
                }
            }
        }

        async function generateSinglePost(type) {
            const formData = {
                date: document.getElementById('lectureDate').value,
                region: document.getElementById('region').value,
                location: document.getElementById('location').value,
                target: document.getElementById('target').value,
                subject: document.getElementById('subject').value,
                notes: document.getElementById('notes').value
            };

            const refreshIcon = document.getElementById(`refresh-${type}`);
            refreshIcon.classList.add('loading-spinner');
            const resultArea = document.getElementById(`${type === 'instagram' ? 'insta' : 'blog'}Result`);
            resultArea.innerText = "ìƒì„± ì¤‘ì…ë‹ˆë‹¤...";

            let prompt = "";
            if (type === 'instagram') {
                prompt = `ë‹¤ìŒ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì¸ìŠ¤íƒ€ê·¸ë¨ í¬ìŠ¤íŒ…ì„ ì‘ì„±í•´ì¤˜. ë‚ ì§œ:${formData.date}, ì§€ì—­:${formData.region}, ì¥ì†Œ:${formData.location}, ëŒ€ìƒ:${formData.target}, ì£¼ì œ:${formData.subject}, íŠ¹ì´ì‚¬í•­:${formData.notes}. 
                [í•„ìˆ˜ ì¡°ê±´]
                1. ì²« ë¬¸ì¥ì— ê°•ë ¥í•œ í›… ì‚¬ìš©. ì´ëª¨ì§€ ì ì ˆíˆ ì„ì–´ì„œ ë‹¤ì •í•˜ê²Œ ì‘ì„±.
                2. ë³¸ë¬¸ì—ëŠ” ë§ˆí¬ë‹¤ìš´ ê¸°í˜¸(###, **, __)ë¥¼ ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ë§ ê²ƒ.
                3. '#' ê¸°í˜¸ëŠ” ì˜¤ì§ ë§ˆì§€ë§‰ í•´ì‹œíƒœê·¸ì—ì„œë§Œ ì‚¬ìš©í•  ê²ƒ. ë³¸ë¬¸ ê¸€ì ì•ì—ëŠ” ì ˆëŒ€ ê¸ˆì§€.
                4. í•´ì‹œíƒœê·¸ëŠ” ë§ˆì§€ë§‰ì— ë”± 5ê°œë§Œ ìƒì„±í•  ê²ƒ.`;
            } else {
                prompt = `ë‹¤ìŒ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë„¤ì´ë²„ ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…ì„ ì‘ì„±í•´ì¤˜. ë‚ ì§œ:${formData.date}, ì§€ì—­:${formData.region}, ì¥ì†Œ:${formData.location}, ëŒ€ìƒ:${formData.target}, ì£¼ì œ:${formData.subject}, íŠ¹ì´ì‚¬í•­:${formData.notes}. 
                [í•„ìˆ˜ ì¡°ê±´]
                1. ì œëª©ì€ 'ì§€ì—­ëª… + ì£¼ì œ + ì¶œê°• í›„ê¸°' í‚¤ì›Œë“œë¥¼ ìì—°ìŠ¤ëŸ½ê²Œ ì„ì–´ í‰ë¬¸ìœ¼ë¡œ ì‘ì„±.
                2. 'ë„ì…, ë³¸ë¬¸, ê²°ë¡ 'ì´ë‚˜ 'ì‚¬ì§„ ì‚½ì…' ê°™ì€ ì•ˆë‚´ ë¬¸êµ¬ëŠ” ì ˆëŒ€ í¬í•¨í•˜ì§€ ë§ ê²ƒ.
                3. ë§ˆí¬ë‹¤ìš´ ê¸°í˜¸(###, **, __)ë¥¼ ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ë§ ê²ƒ. ì œëª©ì´ë‚˜ ê°•ì¡°í•˜ê³  ì‹¶ì€ ë¶€ë¶„ì€ ê·¸ëƒ¥ ì¤„ë°”ê¿ˆê³¼ ë„ì–´ì“°ê¸°ë¡œë§Œ êµ¬ë¶„.
                4. '#' ê¸°í˜¸ëŠ” ì˜¤ì§ ë§ˆì§€ë§‰ í•´ì‹œíƒœê·¸ ë‚˜ì—´ ì‹œì—ë§Œ ì‚¬ìš©í•  ê²ƒ.
                5. '[ì¶”ì²œ íƒœê·¸]' ê°™ì€ ë¨¸ë¦¬ë§ ì—†ì´, ë§ˆì§€ë§‰ì— í•´ì‹œíƒœê·¸ë“¤(#íƒœê·¸1 #íƒœê·¸2...)ë§Œ ì­‰ ë‚˜ì—´í•´ì„œ ë§ˆë¬´ë¦¬í•  ê²ƒ.
                6. ë¯¸ìˆ êµì‚¬ ì¶œì‹  ê°•ì‚¬ì˜ ì „ë¬¸ì„±ê³¼ ë”°ëœ»í•¨ì´ ëŠê»´ì§€ëŠ” ìŠ¤í† ë¦¬í…”ë§ìœ¼ë¡œ ì‘ì„±.`;
            }

            try {
                const text = await fetchAI(prompt);
                if (text) {
                    // í•œë²ˆ ë” í•„í„°ë§ (ì•ˆì „ì¥ì¹˜)
                    let cleanText = text.replace(/###|[*]{1,2}|[_]{1,2}/g, '');
                    cleanText = cleanText.replace(/\[ì‚¬ì§„ ì‚½ì…\]|\[ì‚¬ì§„ì‚½ì…\]|\[ì¶”ì²œ íƒœê·¸\]|\[ì¶”ì²œíƒœê·¸\]/g, '');
                    resultArea.innerText = cleanText.trim();
                }
            } catch (e) {
                resultArea.innerText = "ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. API í‚¤ë¥¼ í™•ì¸í•˜ì„¸ìš”.";
            } finally {
                refreshIcon.classList.remove('loading-spinner');
            }
        }

        async function generateAllPosts() {
            const btnIcon = document.getElementById('btnIcon');
            const btnText = document.getElementById('btnText');
            
            btnIcon.className = "fas fa-spinner loading-spinner";
            btnText.innerText = "ìƒì„± ì¤‘...";

            await Promise.all([
                generateSinglePost('instagram'),
                generateSinglePost('blog')
            ]);

            btnIcon.className = "fas fa-paper-plane";
            btnText.innerText = "ì „ì²´ í¬ìŠ¤íŒ… ìƒì„±í•˜ê¸°";
        }

        function copyContent(elementId, btnTextId) {
            const text = document.getElementById(elementId).innerText;
            if (!text || text.includes("ì •ë³´ë¥¼ ì…ë ¥í•˜ê³ ")) return;

            const textArea = document.createElement("textarea");
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            
            try {
                document.execCommand('copy');
                const btnText = document.getElementById(btnTextId);
                const originalText = btnText.innerText;
                btnText.innerText = "ë³µì‚¬ë¨!";
                setTimeout(() => btnText.innerText = originalText, 2000);
            } catch (err) {
                console.error('Copy failed');
            }
            document.body.removeChild(textArea);
        }
    </script>
</body>
</html>
